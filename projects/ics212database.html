<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="title" content="ICS 212 Final C project | Anson Leung | Professional Portfolio">
    <meta name="description" content="">
    <meta name="image" content="https://github.com/Anson2Leung.png">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Anson Leung | Professional Portfolio">
    <meta property="og:url" content="https://Anson2Leung.github.io/projects/ics212database.html">
    <meta property="og:title" content="ICS 212 Final C project | Anson Leung | Professional Portfolio">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://github.com/Anson2Leung.png">
    <link rel="shortcut icon" href="/favicon.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/techfolio-theme/purple.css">
    <link rel="stylesheet" type="text/css" href="/css/rouge/github.css">
    <!-- Load MathJax if 'mathjax: true' is found in your _config.yml. -->
    
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML">
    </script>
    

    <title>ICS 212 Final C project | Anson Leung | Professional Portfolio</title>
  </head>
  <body>
  <header class="navbar navbar-expand navbar-light bg-light bg-gradient border-bottom">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">Anson Leung</a>
    <div class="ms-auto">
      <ul class="navbar-nav mb-2 mb-lg-0">
        <a class="nav-link" href="/#projects">Projects</a>
        <a class="nav-link" href="/#essays">Essays</a>
        <a class="nav-link" href="/resume.html">Resume</a>
      </ul>
    </div>
  </div>
</header>

<div class="container py-4">
  <h1 class="display-4">ICS 212 Final C project</h1>
 <p><img width="30%" class="img-fluid" src="../img/ics212database/ICS212Project1.png" /></p>

<h1 id="overview">Overview</h1>
<p>The final coding assignment in ICS 212, Spring 2023. This project primarily helped me learn how to read and write data into a txt file.</p>

<p>Using a linked list to store account information such as their account number, name and address, allowing for a user to interact and add new entries or remove entries in the database.</p>

<p>When the user is done, the data is saved into a txt file, which will be read upon the next startup of the program.</p>

<h1 id="difficulties">Difficulties</h1>
<h2 id="saving-data">Saving Data</h2>
<h3 id="writing-data-to-a-file">Writing data to a file</h3>
<p>The purpose of the writefile function is to iterate through the linkedlist database, read each record object and save that data into a txt file.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">writefile</span><span class="p">(</span><span class="k">struct</span> <span class="n">record</span><span class="o">*</span> <span class="n">database</span><span class="p">,</span> <span class="kt">char</span> <span class="n">filename</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">struct</span> <span class="n">record</span><span class="o">*</span> <span class="n">curr_Record</span> <span class="o">=</span> <span class="n">database</span><span class="p">;</span>
    <span class="kt">FILE</span> <span class="o">*</span><span class="n">file</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span> <span class="n">filename</span><span class="p">,</span> <span class="s">"w"</span> <span class="p">);</span>
    
    <span class="k">while</span> <span class="p">(</span><span class="n">curr_Record</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">fprintf</span> <span class="p">(</span> <span class="n">file</span><span class="p">,</span> <span class="s">"%d</span><span class="se">\n</span><span class="s">%s%s;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">curr_Record</span><span class="o">-&gt;</span><span class="n">accountno</span><span class="p">,</span> <span class="n">curr_Record</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">curr_Record</span><span class="o">-&gt;</span><span class="n">address</span><span class="p">);</span>
        <span class="n">curr_Record</span> <span class="o">=</span> <span class="n">curr_Record</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">fclose</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<h3 id="memory-leak-prevention">Memory leak prevention</h3>
<p>Accomplished by iterating through the linkedlist, using the free function to release space reserved by the malloc function, before removing their pointers.</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">cleanup</span><span class="p">(</span><span class="k">struct</span> <span class="n">record</span><span class="o">**</span> <span class="n">database</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">struct</span> <span class="n">record</span><span class="o">*</span> <span class="n">curr</span><span class="p">;</span>
    <span class="n">curr</span> <span class="o">=</span> <span class="o">*</span><span class="n">database</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span> <span class="n">curr</span> <span class="o">!=</span> <span class="nb">NULL</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">struct</span> <span class="n">record</span> <span class="o">*</span> <span class="n">temp</span><span class="p">;</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">curr</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
        <span class="n">curr</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
        <span class="n">free</span> <span class="p">(</span><span class="n">curr</span><span class="p">);</span>
        <span class="n">curr</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="adding-data-to-the-linkedlist-database-from-a-txt-file">Adding data to the linkedlist “database” from a txt file</h3>
<p>This readfile function was the main source of difficulty. The reason being the open-ended nature on how to save our data into a txt file. I decided to put each value for each record on their own line. But that causes a problem for an account holder’s address, which allows for multiple line addresses.</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">readfile</span><span class="p">(</span><span class="k">struct</span> <span class="n">record</span><span class="o">**</span> <span class="n">database</span><span class="p">,</span> <span class="kt">char</span> <span class="n">filename</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="kt">FILE</span> <span class="o">*</span><span class="n">file</span><span class="p">;</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span> <span class="n">filename</span><span class="p">,</span> <span class="s">"r"</span> <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">file</span> <span class="o">!=</span> <span class="nb">NULL</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">anum</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span> <span class="n">EOF</span> <span class="o">!=</span> <span class="n">fscanf</span> <span class="p">(</span> <span class="n">file</span><span class="p">,</span> <span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">anum</span> <span class="p">))</span>
        <span class="p">{</span>
            <span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="sc">'\0'</span><span class="p">;</span>
            <span class="kt">char</span> <span class="n">aname</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>
            <span class="kt">char</span> <span class="n">aaddress</span><span class="p">[</span><span class="mi">50</span><span class="p">]</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>
            <span class="n">fgetc</span> <span class="p">(</span><span class="n">file</span><span class="p">);</span>
            <span class="n">fgets</span> <span class="p">(</span> <span class="n">aname</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">file</span> <span class="p">);</span>
            <span class="k">while</span> <span class="p">(</span> <span class="n">c</span> <span class="o">!=</span> <span class="sc">';'</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">fgetc</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span> <span class="n">c</span> <span class="o">!=</span> <span class="sc">';'</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">strncat</span><span class="p">(</span> <span class="n">aaddress</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">fgetc</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
            <span class="n">addRecord</span> <span class="p">(</span> <span class="n">database</span><span class="p">,</span> <span class="n">anum</span><span class="p">,</span> <span class="n">aname</span><span class="p">,</span> <span class="n">aaddress</span> <span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">debugMode</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">printf</span><span class="p">(</span> <span class="s">"readfile added a record</span><span class="se">\n</span><span class="s">"</span> <span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">fclose</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
<span class="err">}</span>
</code></pre></div></div>
<h3 id="function-to-create-a-linked-node">Function to create a linked node</h3>
<p>All the data collected by readfile is used to create the records in the linkedlist database using this addRecord function.</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">addRecord</span><span class="p">(</span><span class="k">struct</span> <span class="n">record</span><span class="o">**</span> <span class="n">database</span><span class="p">,</span> <span class="kt">int</span> <span class="n">actnum</span><span class="p">,</span> <span class="kt">char</span> <span class="n">name</span><span class="p">[],</span> <span class="kt">char</span> <span class="n">address</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="k">struct</span> <span class="n">record</span><span class="o">*</span> <span class="n">new_Record</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">record</span><span class="o">*</span> <span class="n">prev_Record</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">record</span><span class="o">*</span> <span class="n">curr_Record</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">done</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">debugMode</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">"D: addRecord has been called with database** %p, account number %d,</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">database</span><span class="p">,</span> <span class="n">actnum</span> <span class="p">);</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">"the name: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">name</span> <span class="p">);</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">"the address: %s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">address</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="n">new_Record</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">record</span><span class="o">*</span><span class="p">)</span> <span class="n">malloc</span><span class="p">(</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">record</span><span class="p">)</span> <span class="p">);</span>
    <span class="n">done</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

    <span class="n">new_Record</span><span class="o">-&gt;</span><span class="n">accountno</span> <span class="o">=</span> <span class="n">actnum</span><span class="p">;</span>
    <span class="n">strncpy</span><span class="p">(</span> <span class="n">new_Record</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="mi">30</span> <span class="p">);</span>
    <span class="n">strncpy</span><span class="p">(</span> <span class="n">new_Record</span><span class="o">-&gt;</span><span class="n">address</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="mi">50</span> <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span> <span class="o">*</span><span class="n">database</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">new_Record</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
        <span class="o">*</span><span class="n">database</span> <span class="o">=</span> <span class="n">new_Record</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">actnum</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">*</span><span class="n">database</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">accountno</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">new_Record</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="o">*</span><span class="n">database</span><span class="p">;</span>
        <span class="o">*</span><span class="n">database</span> <span class="o">=</span> <span class="n">new_Record</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">actnum</span> <span class="o">==</span> <span class="p">(</span><span class="o">*</span><span class="n">database</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">accountno</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">new_Record</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
        <span class="p">(</span><span class="o">*</span><span class="n">database</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">new_Record</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">prev_Record</span> <span class="o">=</span> <span class="o">*</span><span class="n">database</span><span class="p">;</span>
        <span class="n">curr_Record</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">database</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span> <span class="n">done</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">curr_Record</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">new_Record</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
                <span class="n">prev_Record</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">new_Record</span><span class="p">;</span>
                <span class="n">done</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">curr_Record</span><span class="o">-&gt;</span><span class="n">accountno</span> <span class="o">&lt;</span> <span class="n">actnum</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">prev_Record</span> <span class="o">=</span> <span class="n">curr_Record</span><span class="p">;</span>
                <span class="n">curr_Record</span> <span class="o">=</span> <span class="n">curr_Record</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> 
            <span class="p">{</span>
                <span class="n">new_Record</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">prev_Record</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
                <span class="n">prev_Record</span><span class="o">-&gt;</span><span class="n">next</span> <span class="o">=</span> <span class="n">new_Record</span><span class="p">;</span>
                <span class="n">done</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">debugMode</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span> <span class="s">"</span><span class="se">\n</span><span class="s">D: addRecord finished</span><span class="se">\n</span><span class="s">"</span> <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h1 id="final-thoughts">Final Thoughts</h1>
<p>What I learned from this project was that I had quite the hard time with pointers. It took me a long time to understand the uses between pointers and dereferences (since they both are signaled with an asterisk).</p>

</div>

<footer class="navbar navbar-expand navbar-light bg-light bg-gradient border-top">
  <div class="container-fluid">
    <div class="ms-auto">
      <ul class="navbar-nav mb-2 mb-lg-0">
        <small><a class="nav-link" href="https://techfolios.github.io">Made with Techfolios</a></small>
      </ul>
    </div>
  </div>
</footer>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
  </body>
</html>
